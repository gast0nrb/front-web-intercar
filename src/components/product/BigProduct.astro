---
const { url } = Astro.props;
import { Image } from "astro:assets";
const getProduct = async () => {
  try {
    const getData = await fetch(url, { method: "GET", mode: "cors" });
    const jsonData = await getData.json();
    return jsonData.data;
  } catch (err) {
    return err;
  }
};
const data = await getProduct();
---

<div
  class="w-11/12 mx-auto grid md:grid-cols-2 xs:grid-cols-1 my-10 rounded-xs md:gap-5"
>
  <div class="" id="picture">
    <p class="bg-neutral-900 text-neutral-300 pl-3 rounded-tl-xs">
      SKU: {data.sku}
    </p>
    <Image
      src={`http://localhost:8080/api/intercar/products/${data.sku}/photo`}
      alt="product-image"
      width={500}
      height={600}
      crossorigin={"anonymous"}
      class="w-full h-full object-cover rounded-tl-xs"
    />
  </div>
  <div class="bg-neutral-100 drop-shadow-lg" id="descripcion">
    <div class="title">
      <h3
        class="xs:text-xl md:text-2xl font-bold text-center bg-neutral-900 text-orange-500 rounded-t-xs"
      >
        {data.title.toUpperCase()}
      </h3>
    </div>
    <div class="p-1" id="description">
      <p class="xs:text-sm md:text-lg text-center">{data.description}</p>
    </div>
    <div class="text-center" id="precios">
      <h3 class="bg-neutral-200 font-bold">VALORES</h3>
      <p>${data.price.toLocaleString("es-CL")}</p>
    </div>
    <div class="text-center" id="precios">
      <h3 class="bg-neutral-200 font-bold">PORCENTAJE DESCUENTO</h3>
      <p>{data.discount} %</p>
    </div>
    <div class="text-center" id="categorias">
      <h3 class="bg-neutral-200 font-bold">CATEGORIA</h3>
      <a
        class="underline text-orange-300 hover:text-orange-500"
        href={`/categorias/${data.SUBCATEGORY.CATEGORY.id}?page=0`}
        >{data.SUBCATEGORY.CATEGORY.name.toLowerCase()}</a
      >
    </div>
    <div class="text-center" id="categorias">
      <h3 class="bg-neutral-200 font-bold">SUBCATEGORIA</h3>
      <a
        class="underline text-orange-300 hover:text-orange-500"
        href={`/subcategoria/${data.SUBCATEGORY.id}?category=${data.SUBCATEGORY.fk_category}&page=0`}
        >{data.SUBCATEGORY.name.toLowerCase()}</a
      >
    </div>
    <div id="wsp-button" class="mt-5 mb-5 md:text-sm xs:text-xs">
      <a
        href={`https://wa.me/+56942151261?text=Me%20interesa%20este%20producto%3A${data.title.toUpperCase()}%20con%20sku%20${data.sku.toUpperCase()}`}
        target="_blank"
        class="bg-green-200 flex gap-1 w-fit p-1 rounded-sm opacity-60 text-zinc-500 mx-auto
         hover:opacity-100 duration-200 shadow-xl hover:text-zinc-800 hover:bg-green-500"
      >
        Me interesa este producto
        <img src="/wsp.png" class="xs:w-5 md:w-6 -mt-1" />
      </a>
    </div>
  </div>
</div>
